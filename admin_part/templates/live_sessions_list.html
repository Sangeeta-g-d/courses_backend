{% extends 'admin_base.html' %}
{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold">Live Sessions</h3>
    <a href="{% url 'add_live_session' %}" class="btn btn-primary shadow-sm">
      <i class="bi bi-plus-lg"></i> Add New Session
    </a>
  </div>

  {% if sessions %}
  <div class="row g-4">
    {% for s in sessions %}
    <div class="col-md-4 col-lg-3">
      <div class="card shadow-sm border-0 h-100">
        <div class="position-relative">
          <img src="{{ s.thumbnail.url }}" class="card-img-top" alt="{{ s.title }}" style="height:180px; object-fit:cover;">
          {% if s.is_active %}
          <span class="badge bg-success position-absolute top-0 end-0 m-2 px-3 py-2 rounded-pill shadow">Active</span>
          {% else %}
          <span class="badge bg-secondary position-absolute top-0 end-0 m-2 px-3 py-2 rounded-pill shadow">Upcoming</span>
          {% endif %}
        </div>

        <div class="card-body d-flex flex-column">
          <h5 class="card-title mb-2">{{ s.title }}</h5>
          <p class="text-muted small mb-2">
            <i class="bi bi-calendar-event me-1"></i> {{ s.session_date }} <br>
            <i class="bi bi-clock me-1"></i> {{ s.session_time }}
          </p>
          <p class="text-muted small flex-grow-1">{{ s.agenda|truncatewords:10 }}</p>

          <div class="d-flex justify-content-between mt-2">
            {% if s.is_active %}
              <a href="{% url 'join_live_session' s.id %}" class="btn btn-sm btn-success">
                <i class="bi bi-camera-video"></i> Join Now
              </a>
            {% else %}
              <button class="btn btn-sm btn-outline-secondary" disabled>
                <i class="bi bi-clock"></i> Not Live
              </button>
            {% endif %}

            <a href="{% url 'edit_live_session' s.id %}" class="btn btn-sm btn-outline-warning">
              <i class="bi bi-pencil-square"></i> Edit
            </a>
            <a href="{% url 'delete_live_session' s.id %}" 
               class="btn btn-sm btn-outline-danger"
               onclick="return confirm('Delete this session?')">
              <i class="bi bi-trash"></i> Delete
            </a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="text-center py-5">
    <img src="https://cdn-icons-png.flaticon.com/512/4076/4076549.png" width="120" class="mb-3" alt="">
    <h5>No live sessions yet</h5>
    <p class="text-muted">Click “Add New Session” to create one.</p>
  </div>
  {% endif %}
</div>

{% include 'notify.html' %}
{% endblock %}
